<!doctype html><html lang="en"><head><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta name="viewport" content="width=device-width, initial-scale=1" /><link rel="stylesheet" href="/phenomic.browser.9106c6d0d0e2a493cc4e.css" /><meta data-react-helmet="true" name="generator" content="Phenomic 0.16.2"/><meta data-react-helmet="true" property="og:site_name" content="istanbuljs-website"/><meta data-react-helmet="true" name="twitter:site" content="@"/><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="Using Istanbul With Mocha"/><meta data-react-helmet="true" property="og:url" content="http://istanbul.js.org/docs/tutorials/mocha/"/><meta data-react-helmet="true" property="og:description" content="Istanbul is extensively tested with mocha, which we use for many of our own repos. At the end of the day, all you need to do is place the…"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="Using Istanbul With Mocha"/><meta data-react-helmet="true" name="twitter:creator" content="@"/><meta data-react-helmet="true" name="twitter:description" content="Istanbul is extensively tested with mocha, which we use for many of our own repos. At the end of the day, all you need to do is place the…"/><meta data-react-helmet="true" name="description" content="Istanbul is extensively tested with mocha, which we use for many of our own repos. At the end of the day, all you need to do is place the…"/><title data-react-helmet="true">Using Istanbul With Mocha</title></head><body><div id="phenomic"><div class="_2uLnB" data-reactroot="" data-reactid="1" data-react-checksum="-988394232"><!-- react-empty: 2 --><!-- react-empty: 3 --><style data-reactid="4">@-ms-viewport { width: device-width; }</style><header class="_2gGRo" data-reactid="5"><nav class="_2frUm" data-reactid="6"><div class="_37D8R" data-reactid="7"><a class="Ezg15" href="/" data-reactid="8"><img alt="istanbul logo" src="/assets/istanbul-logo.png" class="ENT8c" data-reactid="9"/><span class="_2qOdn" data-reactid="10">istanbul</span></a></div><div class="_3VLYQ" data-reactid="11"><a class="Ezg15" href="/docs/tutorials/" data-reactid="12">Tutorials</a><a class="Ezg15" href="/docs/advanced/" data-reactid="13">Advanced Features</a><a class="Ezg15" href="/contributing/" data-reactid="14">Contributing</a><!-- react-text: 15 --><!-- /react-text --><a href="https://github.com/istanbuljs" class="Ezg15" data-reactid="16"><span class="SVGInline SVGInline--cleaned" data-reactid="17"><svg class="SVGInline-svg SVGInline--cleaned-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 0C5.374 0 0 5.373 0 12c0 5.302 3.438 9.8 8.207 11.387.6.11.793-.26.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.09-.745.083-.73.083-.73 1.205.085 1.84 1.238 1.84 1.238 1.07 1.834 2.806 1.304 3.49.997.108-.776.42-1.306.763-1.605-2.665-.305-5.467-1.334-5.467-5.93 0-1.312.47-2.382 1.236-3.222-.125-.303-.536-1.524.116-3.176 0 0 1.008-.322 3.3 1.23A11.51 11.51 0 0 1 12 5.803c1.02.005 2.047.138 3.006.404 2.29-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.236 1.91 1.236 3.22 0 4.61-2.807 5.625-5.48 5.922.43.372.824 1.102.824 2.222v3.293c0 .32.192.694.8.576C20.567 21.796 24 17.3 24 12c0-6.627-5.373-12-12-12z"/></svg></span><!-- react-text: 18 -->GitHub<!-- /react-text --></a></div></nav></header><div class="_2q8yI" data-reactid="19"><div data-reactid="20"><div data-reactid="21"><!-- react-empty: 22 --><div class="_2NPeC _3x8Y9" data-reactid="23"><div class="_2BsDj _28uC5" data-reactid="24"><h1 data-reactid="25">Using Istanbul With Mocha</h1><div data-reactid="26"><div class="phenomic-BodyContainer" data-reactid="27"><p><em>Istanbul is extensively tested with <a href="https://mochajs.org/">mocha</a>, which we use for many of our own repos.</em></p>
<p>At the end of the day, all you need to do is place the bin <strong>nyc</strong> in front of the
existing test scripts in your package.json:</p>
<pre><code class="hljs language-json">{
  <span class="hljs-attr">"scripts"</span>: {
    <span class="hljs-attr">"test"</span>: <span class="hljs-string">"nyc mocha --timeout=3000"</span>
  }
}</code></pre>
<p><em>that's it!</em> this will instrument the code that your tests execute, and any
subprocesses that it spawns.</p>
<h2 id="using-alternative-reporters"><a href="#using-alternative-reporters" class="phenomic-HeadingAnchor">#</a>Using Alternative Reporters</h2>
<p>By default nyc uses Istanbul's <code>text</code> reporter. Various other reporters are
available in the <a href="https://github.com/istanbuljs/istanbul-reports/tree/master/lib">istanbul-reports</a>
repo.</p>
<p>If you'd like to specify alternate reporter, or would like to run
multiple reporters, simply use the <code>--reporter</code> flag.</p>
<p><em>for instance, suppose you would like to output the default text report, along
with an HTML coverage report.</em></p>
<pre><code class="hljs language-json">{
  <span class="hljs-attr">"scripts"</span>: {
    <span class="hljs-attr">"test"</span>: <span class="hljs-string">"nyc --reporter=html --reporter=text mocha"</span>
  }
}</code></pre>
<p>This will output the <code>text</code> report to the terminal, as well as outputting the
detailed <code>html</code> report to <code>./coverage/index.html</code>.</p>
<h2 id="integrating-with-coveralls"><a href="#integrating-with-coveralls" class="phenomic-HeadingAnchor">#</a>Integrating with Coveralls</h2>
<p><a href="https://coveralls.io">coveralls.io</a> is a great tool for adding coverage reporting to your continuous-integration flow. Here's how to get Istanbul
integrated with coveralls and <a href="https://travis-ci.org/">travis-ci.org</a>:</p>
<ol>
<li>add the coveralls dependency to your module:</li>
</ol>
<pre><code class="hljs language-bash">npm install coveralls --save-dev</code></pre>
<ol start="2">
<li>update the scripts in your package.json to include a bin for reporting coverage to coveralls:</li>
</ol>
<pre><code class="hljs language-json">{
  <span class="hljs-attr">"script"</span>: {
     <span class="hljs-attr">"test"</span>: <span class="hljs-string">"nyc --reporter=html --reporter=text mocha"</span>,
     <span class="hljs-attr">"coverage"</span>: <span class="hljs-string">"nyc report --reporter=text-lcov | coveralls"</span>
  }
}</code></pre>
<ol start="3">
<li>
<p>For private repos, add the environment variable <code>COVERALLS_REPO_TOKEN</code> to Travis.</p>
</li>
<li>
<p>add the following to your <code>.travis.yml</code>:</p>
</li>
</ol>
<pre><code class="hljs language-yaml"><span class="hljs-attr">after_success:</span> npm run coverage</code></pre>
<h2 id="what-now"><a href="#what-now" class="phenomic-HeadingAnchor">#</a>What Now?</h2>
<p>nyc and Istanbul provide many advanced configuration options a good place to
start learning more is the <a href="https://github.com/istanbuljs/nyc">istanbuljs/nyc README.</a></p>
</div></div></div><section class="_2iNa2" data-reactid="28"><h1 data-reactid="29">Quick Start</h1><p data-reactid="30"><!-- react-text: 31 -->Adding coverage to your <!-- /react-text --><!-- react-text: 32 -->mocha<!-- /react-text --><!-- react-text: 33 --> tests could not be easier<!-- /react-text --></p><div class="sh-code" data-reactid="34">$ npm install --save-dev nyc</div><p data-reactid="35"><!-- react-text: 36 -->Now, simply place the command <!-- /react-text --><strong data-reactid="37">nyc</strong><!-- react-text: 38 --> in front of your existing test command, for example:<!-- /react-text --></p><pre class="lowlight" data-reactid="39"><code class="hljs json" data-reactid="40"><!-- react-text: 41 -->{
  <!-- /react-text --><span class="hljs-attr" data-reactid="42"><!-- react-text: 43 -->&quot;scripts&quot;<!-- /react-text --></span><!-- react-text: 44 -->: {
    <!-- /react-text --><span class="hljs-attr" data-reactid="45"><!-- react-text: 46 -->&quot;test&quot;<!-- /react-text --></span><!-- react-text: 47 -->: <!-- /react-text --><span class="hljs-string" data-reactid="48"><!-- react-text: 49 -->&quot;nyc mocha&quot;<!-- /react-text --></span><!-- react-text: 50 -->
  }
}<!-- /react-text --></code></pre></section></div></div></div></div><footer class="_1Ustb" data-reactid="51"><p data-reactid="52"><iframe allowtransparency="true" frameborder="0" scrolling="0" style="width:135px;height:30px;vertical-align:middle;" src="https://ghbtns.com/github-btn.html?user=istanbuljs&amp;repo=nyc&amp;type=star&amp;count=true&amp;size=large" data-reactid="53"></iframe><a href="https://github.com/istanbuljs" data-reactid="54">Istanbul</a><!-- react-text: 55 --> · <!-- /react-text --><!-- react-text: 56 -->v1<!-- /react-text --><!-- react-text: 57 --> · <!-- /react-text --><!-- react-text: 58 -->Revised BSD License<!-- /react-text --></p><p data-reactid="59"><a class="_21LuU" data-reactid="60"><!-- react-text: 61 -->Website generated with <!-- /react-text --><span class="MMp-P" data-reactid="62">&lt;Phenomic /&gt;</span></a></p></footer></div></div><script>window.__COLLECTION__ = [{"layout":"PageError","route":"404.html","description":"Content here not used, see web_modules/layouts/PageError","__filename":"404.md","__url":"/404.html","__resourceUrl":"/404.html","__dataUrl":"/404.html.f3d82a4d938b593823c37ead979b3b86.json"},{"title":"Contributing to Istanbul","description":"We would love to have you contribute to the Istanbul project, be it: creating a detailed bug report. adding a cool new feature. fixing…","__filename":"contributing/index.md","__url":"/contributing/","__resourceUrl":"/contributing/index.html","__dataUrl":"/contributing/index.html.a823c14226ce2bec7a0575222027c1d3.json"},{"title":"Istanbul Blog","layout":"PostsList","description":"","__filename":"blog/index.md","__url":"/blog/","__resourceUrl":"/blog/index.html","__dataUrl":"/blog/index.html.9883d94018e58fbdb700c0246f5b0454.json"},{"metaTitle":"Istanbul, a JavaScript test coverage tool.","superTitle":"JavaScript test coverage made simple.","title":"How Istanbul works","layout":"WithQuickStart","QuickStart":{"title":"mocha","cmd":"mocha"},"description":"Istanbul instruments your ES5 and ES2015+ JavaScript code with line counters, so that you can track how well your unit-tests exercise your…","__filename":"index.md","__url":"/","__resourceUrl":"/index.html","__dataUrl":"/index.html.f5aae3586b78240db46c9fca99ac40d5.json"},{"layout":"PageLoading","description":"Content here not used, see web_modules/layouts/PageLoading. This page is a demo for loading state. You can safely delete if you want.","__filename":"loading.md","__url":"/loading/","__resourceUrl":"/loading/index.html","__dataUrl":"/loading/index.html.4f959959ceecdafbb30e2e8fd2869cdc.json"},{"title":"Hello World!","date":"2016-02-14T00:00:00.000Z","layout":"Post","description":"Hello there. Here is another dumb post.","__filename":"blog/hello-world.md","__url":"/blog/hello-world/","__resourceUrl":"/blog/hello-world/index.html","__dataUrl":"/blog/hello-world/index.html.71dba0e386497410490147d8e028e650.json"},{"title":"First Post","date":"2016-01-22T00:00:00.000Z","layout":"Post","description":"This is the first post!","__filename":"blog/first-post.md","__url":"/blog/first-post/","__resourceUrl":"/blog/first-post/index.html","__dataUrl":"/blog/first-post/index.html.4a5613b2efb7336faddeb36e490da773.json"},{"title":"Advanced `nyc` Features","description":"Instrumenting source files Process tree information","__filename":"docs/advanced/index.md","__url":"/docs/advanced/","__resourceUrl":"/docs/advanced/index.html","__dataUrl":"/docs/advanced/index.html.f278db8818764c4f22f11743f7e51ea9.json"},{"title":"Process Tree information","layout":"WithQuickStart","QuickStart":{"title":"Process Tree information"},"description":"nyc is able to show you all Node processes that are spawned when running a test script under it:","__filename":"docs/advanced/process-tree.md","__url":"/docs/advanced/process-tree/","__resourceUrl":"/docs/advanced/process-tree/index.html","__dataUrl":"/docs/advanced/process-tree/index.html.002f0569aa6f4f697fc98e1d05e5257a.json"},{"title":"Using Istanbul With ES2015+","layout":"WithQuickStart","QuickStart":{"title":"Using Istanbul With ES2015+"},"description":"In this tutorial I'll walk you through setting up test coverage for your fancy pants ES2015 JavaScript projects. We'll cover two topics:…","__filename":"docs/tutorials/es2015.md","__url":"/docs/tutorials/es2015/","__resourceUrl":"/docs/tutorials/es2015/index.html","__dataUrl":"/docs/tutorials/es2015/index.html.014b8a684acbd6fb7fe55668ebc35caf.json"},{"title":"Using Istanbul With AVA","layout":"WithQuickStart","QuickStart":{"title":"AVA","cmd":"ava"},"description":"At the end of the day, all you need to do is place the bin nyc in front of the existing test scripts in your package.json: that's it! this…","__filename":"docs/tutorials/ava.md","__url":"/docs/tutorials/ava/","__resourceUrl":"/docs/tutorials/ava/index.html","__dataUrl":"/docs/tutorials/ava/index.html.8250ea8166a16577ab5641b36b6fe1e2.json"},{"title":"Instrumenting source files","layout":"WithQuickStart","QuickStart":{"title":"Instrumenting source files"},"description":"nyc's instrument command can be used to instrument source files outside of the context of your unit-tests:","__filename":"docs/advanced/instrument.md","__url":"/docs/advanced/instrument/","__resourceUrl":"/docs/advanced/instrument/index.html","__dataUrl":"/docs/advanced/instrument/index.html.91eb237ec3746772d71d580741acf54a.json"},{"title":"Tutorials","description":"AVA ES2015+ mocha IoT.js tap TypeScript","__filename":"docs/tutorials/index.md","__url":"/docs/tutorials/","__resourceUrl":"/docs/tutorials/index.html","__dataUrl":"/docs/tutorials/index.html.8719802ca800d50d3ce0d6d4837d27d9.json"},{"title":"Using Istanbul With IoT.js","layout":"WithQuickStart","QuickStart":{"title":"Using Istanbul With IoT.js"},"description":"You can also use Istanbul to instrument your IoT.js modules or script files. Since IoT.js is rather minimalistic in design, this will…","__filename":"docs/tutorials/iotjs.md","__url":"/docs/tutorials/iotjs/","__resourceUrl":"/docs/tutorials/iotjs/index.html","__dataUrl":"/docs/tutorials/iotjs/index.html.1185345bd3a02bb6adb6c102f37adc14.json"},{"title":"Using Istanbul With Mocha","layout":"WithQuickStart","QuickStart":{"title":"mocha","cmd":"mocha"},"description":"Istanbul is extensively tested with mocha, which we use for many of our own repos. At the end of the day, all you need to do is place the…","__filename":"docs/tutorials/mocha.md","__url":"/docs/tutorials/mocha/","__resourceUrl":"/docs/tutorials/mocha/index.html","__dataUrl":"/docs/tutorials/mocha/index.html.4cf84f5a06617c8d813f23ee0c628710.json"},{"title":"Using Istanbul With TypeScript & mocha","layout":"WithQuickStart","QuickStart":{"title":"Using Istanbul With TypeScript & mocha"},"description":"Thanks to @mohsen1's post the following is the minimum recommended configuration to get accurate TypeScript coverage with mocha. With this…","__filename":"docs/tutorials/typescript.md","__url":"/docs/tutorials/typescript/","__resourceUrl":"/docs/tutorials/typescript/index.html","__dataUrl":"/docs/tutorials/typescript/index.html.ed520e636f3107c8c3f5d9f359aa67ea.json"},{"title":"Using Istanbul With Node Tap","layout":"WithQuickStart","QuickStart":{"title":"Node Tap"},"description":"Node Tap uses nyc to track code coverage, even across subprocess boundaries. It is included by default, and there’s nothing you need to do…","__filename":"docs/tutorials/tap.md","__url":"/docs/tutorials/tap/","__resourceUrl":"/docs/tutorials/tap/index.html","__dataUrl":"/docs/tutorials/tap/index.html.5981ebe6a57f30bb9d0735fe1a590699.json"},{"title":"Using Istanbul With Webpack","description":"Tutorial coming soon.","__filename":"docs/tutorials/webpack.md","__url":"/docs/tutorials/webpack/","__resourceUrl":"/docs/tutorials/webpack/index.html","__dataUrl":"/docs/tutorials/webpack/index.html.35be98a119eb6b57b014ff2d1757a675.json"}];window.__INITIAL_STATE__ = {"pages":{"/docs/tutorials/mocha/":{"head":{"title":"Using Istanbul With Mocha","layout":"WithQuickStart","QuickStart":{"title":"mocha","cmd":"mocha"},"description":"Istanbul is extensively tested with mocha, which we use for many of our own repos. At the end of the day, all you need to do is place the…"},"body":"<p><em>Istanbul is extensively tested with <a href=\"https://mochajs.org/\">mocha</a>, which we use for many of our own repos.</em></p>\n<p>At the end of the day, all you need to do is place the bin <strong>nyc</strong> in front of the\nexisting test scripts in your package.json:</p>\n<pre><code class=\"hljs language-json\">{\n  <span class=\"hljs-attr\">\"scripts\"</span>: {\n    <span class=\"hljs-attr\">\"test\"</span>: <span class=\"hljs-string\">\"nyc mocha --timeout=3000\"</span>\n  }\n}</code></pre>\n<p><em>that's it!</em> this will instrument the code that your tests execute, and any\nsubprocesses that it spawns.</p>\n<h2 id=\"using-alternative-reporters\"><a href=\"#using-alternative-reporters\" class=\"phenomic-HeadingAnchor\">#</a>Using Alternative Reporters</h2>\n<p>By default nyc uses Istanbul's <code>text</code> reporter. Various other reporters are\navailable in the <a href=\"https://github.com/istanbuljs/istanbul-reports/tree/master/lib\">istanbul-reports</a>\nrepo.</p>\n<p>If you'd like to specify alternate reporter, or would like to run\nmultiple reporters, simply use the <code>--reporter</code> flag.</p>\n<p><em>for instance, suppose you would like to output the default text report, along\nwith an HTML coverage report.</em></p>\n<pre><code class=\"hljs language-json\">{\n  <span class=\"hljs-attr\">\"scripts\"</span>: {\n    <span class=\"hljs-attr\">\"test\"</span>: <span class=\"hljs-string\">\"nyc --reporter=html --reporter=text mocha\"</span>\n  }\n}</code></pre>\n<p>This will output the <code>text</code> report to the terminal, as well as outputting the\ndetailed <code>html</code> report to <code>./coverage/index.html</code>.</p>\n<h2 id=\"integrating-with-coveralls\"><a href=\"#integrating-with-coveralls\" class=\"phenomic-HeadingAnchor\">#</a>Integrating with Coveralls</h2>\n<p><a href=\"https://coveralls.io\">coveralls.io</a> is a great tool for adding coverage reporting to your continuous-integration flow. Here's how to get Istanbul\nintegrated with coveralls and <a href=\"https://travis-ci.org/\">travis-ci.org</a>:</p>\n<ol>\n<li>add the coveralls dependency to your module:</li>\n</ol>\n<pre><code class=\"hljs language-bash\">npm install coveralls --save-dev</code></pre>\n<ol start=\"2\">\n<li>update the scripts in your package.json to include a bin for reporting coverage to coveralls:</li>\n</ol>\n<pre><code class=\"hljs language-json\">{\n  <span class=\"hljs-attr\">\"script\"</span>: {\n     <span class=\"hljs-attr\">\"test\"</span>: <span class=\"hljs-string\">\"nyc --reporter=html --reporter=text mocha\"</span>,\n     <span class=\"hljs-attr\">\"coverage\"</span>: <span class=\"hljs-string\">\"nyc report --reporter=text-lcov | coveralls\"</span>\n  }\n}</code></pre>\n<ol start=\"3\">\n<li>\n<p>For private repos, add the environment variable <code>COVERALLS_REPO_TOKEN</code> to Travis.</p>\n</li>\n<li>\n<p>add the following to your <code>.travis.yml</code>:</p>\n</li>\n</ol>\n<pre><code class=\"hljs language-yaml\"><span class=\"hljs-attr\">after_success:</span> npm run coverage</code></pre>\n<h2 id=\"what-now\"><a href=\"#what-now\" class=\"phenomic-HeadingAnchor\">#</a>What Now?</h2>\n<p>nyc and Istanbul provide many advanced configuration options a good place to\nstart learning more is the <a href=\"https://github.com/istanbuljs/nyc\">istanbuljs/nyc README.</a></p>\n","__filename":"docs/tutorials/mocha.md","__url":"/docs/tutorials/mocha/","__resourceUrl":"/docs/tutorials/mocha/index.html","__dataUrl":"/docs/tutorials/mocha/index.html.4cf84f5a06617c8d813f23ee0c628710.json","type":"WithQuickStart"}}}</script><script data-react-helmet="true" src="https://cdn.polyfill.io/v2/polyfill.min.js"></script><script src="/phenomic.browser.9106c6d0d0e2a493cc4e.js"></script></body></html>